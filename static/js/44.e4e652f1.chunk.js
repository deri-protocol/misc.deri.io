(this["webpackJsonpderi-client"]=this["webpackJsonpderi-client"]||[]).push([[44],{2694:function(e,t,n){"use strict";n.r(t);var c=n(0),i=n(2),a=n(10),s=(n(602),n(108)),o=n(55),r=n(5),l=n(176),d=n(177),u=n(596),j=n(40),b=n(318),h=n(90),p=n.n(h),O=n(20),x=n(240),m=n(30),v=n(3);t.default=Object(o.b)("wallet")(Object(o.c)((function(e){var t=e.wallet,n=e.lang,o=Object(r.useState)(),h=Object(a.a)(o,2),f=h[0],g=h[1],N=Object(r.useState)([]),k=Object(a.a)(N,2),w=k[0],y=k[1],I=Object(r.useState)(0),S=Object(a.a)(I,2),E=S[0],C=S[1],D=Object(r.useState)(),L=Object(a.a)(D,2),P=(L[0],L[1],Object(r.useState)(!1)),R=Object(a.a)(P,2),V=R[0],B=R[1],F=Object(r.useState)(!0),T=Object(a.a)(F,2),U=T[0],q=T[1],A=Object(r.useState)(!1),M=Object(a.a)(A,2),_=M[0],z=M[1],H=Object(r.useState)(0),J=Object(a.a)(H,2),Y=J[0],W=J[1],Z=Object(r.useState)(0),G=Object(a.a)(Z,2),K=G[0],Q=G[1],X=Object(r.useState)(""),$=Object(a.a)(X,2),ee=$[0],te=$[1],ne=Object(r.useState)(0),ce=Object(a.a)(ne,2),ie=ce[0],ae=ce[1],se=Object(d.c)(),oe=Object(x.a)("IERC721",42161),re=Object(x.a)("LpTokenId",42161),le=Object(x.a)("PairAbi",42161),de=Object(x.a)("arbitrumLp",42161),ue=Object(r.useCallback)((function(e){if(!_){var t=document.getElementById("I"),n=document.getElementById("II"),c=document.getElementById("III"),i=document.getElementById("VI");"1"===e?t.click():"2"===e?n.click():"3"===e?c.click():"4"===e&&i.click(),g(e)}}),[_]),je=function(){var e=Object(i.a)(Object(c.a)().mark((function e(){var n;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.request("getUserVotingPower",[t.detail.account]);case 2:n=e.sent,W(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),be=function(){var e=Object(i.a)(Object(c.a)().mark((function e(){var n;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.request("getUserVotingResult",[t.detail.account]);case 2:n=e.sent,console.log("getUserVotingResult",n),"0"!==n.option?(g(n.option),z(!0)):z(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),he=Object(r.useCallback)(Object(i.a)(Object(c.a)().mark((function e(){var n,s,o,r,l,d,u,j,b,h;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe.balanceOf(t.detail.account);case 2:n=e.sent,n=m.a.from(n._hex).toString(),s=[],o=0;case 6:if(!(o<n)){e.next=15;break}return e.next=9,oe.tokenOfOwnerByIndex(t.detail.account,o);case 9:r=e.sent,r=m.a.from(r._hex).toString(),s.push(r);case 12:o++,e.next=6;break;case 15:l=[],d=0;case 17:if(!(d<s.length)){e.next=25;break}return e.next=20,de.getPositionInfo(s[d]);case 20:e.sent[0].toLocaleLowerCase()==="0x96C3966534b4377691e11e163A0409Ad01667343".toLocaleLowerCase()&&l.push(s[d]);case 22:d++,e.next=17;break;case 25:return u=l.map(function(){var e=Object(i.a)(Object(c.a)().mark((function e(t){var n,i;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},e.next=3,re.positions(t);case 3:return i=e.sent,n={tickLower:i.tickLower,tickUpper:i.tickUpper,liquidity:m.a.from(i.liquidity._hex).toString()},e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=28,Promise.all(u);case 28:return u=e.sent,e.next=31,le.slot0();case 31:j=(j=e.sent).tick,b=u.map((function(e){var t=Object(O.q)(j,e.tickLower,e.tickUpper,e.liquidity),n=Object(a.a)(t,2),c=n[0],i=n[1];return{deri:c/Math.pow(10,18),eth:i/Math.pow(10,18)}})),h=b.reduce((function(e,t){return e+t.deri}),0),console.log("getArbUniDeri",h),ae(h);case 37:case"end":return e.stop()}}),e)}))),[re,le,oe,t.detail.account,de]),pe=function(){var e=Object(i.a)(Object(c.a)().mark((function e(){var t,n,i,a,s,o,r,l,d,u,j,b,h;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.get("https://vote.deri.io/get_voting_powers");case 2:t=e.sent,console.log("getVotingResult",JSON.parse(t.data[0].votes)),t.data&&t.data[0].votes&&(n=new Date,i=n.getMinutes(),a=n.getHours(),s=1e3*t.data[0].timestamp,o=new Date(s),r=o.getMinutes(),l=o.getHours(),u=a-l,(d=i-r)>=1&&u<=0?te(d):u>0?(j=60-r+Number(i),te(j)):d<1&&("less than 1",te("less than 1")),t=(t=JSON.parse(t.data[0].votes)).map((function(e){return Object(O.a)(e).div(Math.pow(10,18)).toNumber()})),b=Object(O.l)(t),b.max,b.min,h=b.sum,b.maxIndex,C(h),y(t));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Oe=function(){var e=Object(i.a)(Object(c.a)().mark((function e(){var n,i;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.request("getVotingInfo");case 2:n=e.sent,console.log("getVotingInfo",n),n&&n.length&&(i=(i=n.find((function(e){return+e.chainId===+t.detail.chainId}))).dedeadline+"000",(new Date).getTime()>=+i?B(!0):B(!1));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xe=function(){var e=Object(i.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log([t.detail.chainId,t.detail.account,f]),e.next=3,j.a.request("vote",[t.detail.chainId,t.detail.account,f],{includeResponse:!0});case 3:e.sent.success?(je(),be(),pe(),se.success("Success")):se.error("Failed");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){t.isConnected()&&(je(),be(),Oe())}),[t,t.detail]),Object(r.useEffect)((function(){pe()}),[]),Object(r.useEffect)((function(){t.isConnected()&&f&&!_&&!V?q(!1):q(!0)}),[t.detail,f,w,_]),Object(r.useEffect)((function(){var e=0;ie&&Y?e=Object(O.a)(ie).plus(Y).toNumber():Y&&(e=Y),Q(e)}),[ie,Y]),Object(r.useEffect)((function(){oe&&t.detail.account&&de&&re&&le&&he()}),[oe,t.detail.account,de,re,le]),Object(v.jsxs)("div",{className:"dip-box",children:[Object(v.jsxs)("div",{className:"back-governance",children:[Object(v.jsx)(s.b,{to:"/governance",children:Object(v.jsxs)("div",{className:"icon-back",children:[Object(v.jsx)("img",{alt:"",src:b.default}),Object(v.jsx)("span",{children:n.back})]})}),Object(v.jsx)("div",{className:"poll-detail",children:n["poll-detail"]})]}),Object(v.jsxs)("div",{className:"dip-box-info",children:[Object(v.jsxs)("div",{className:"poll-dip-info ",children:[Object(v.jsxs)("div",{className:"dip-list-title",children:[Object(v.jsxs)("div",{className:"title-text",children:[n.dip,"-006"]}),Object(v.jsxs)("div",{className:"dip-progress",children:[Object(v.jsx)("div",{className:"progress-bg"}),"PROCESSING"]})]}),Object(v.jsx)("div",{className:"dip-list-des ",children:"Vote for Deri V4\u2019s First i-Chain"}),Object(v.jsx)("div",{className:"dip-time",children:"Target End Time: 2023 Sep 8th 10:00:00AM UTC (subject to extension, see below for details)"})]}),Object(v.jsxs)("div",{className:"dip-option",children:[Object(v.jsxs)("div",{className:"1"===f?"option-check option-checked":"option-check",onClick:function(e){return ue("1")},children:[Object(v.jsxs)("div",{className:"dip-one-option-title option-title",children:[Object(v.jsxs)("div",{className:"option-check-text",children:[Object(v.jsx)("input",{type:"radio",name:"option",value:"1",id:"I",onChange:function(e){return ue("1")},checked:"1"===f}),Object(v.jsx)("label",{for:"I"}),Object(v.jsx)("span",{className:"option-title-text",children:"Arbitrum"})]}),Object(v.jsxs)("div",{className:"option-num",children:[w[0]?w[0].toFixed(0):0," ",n["deri-voting"]," (",E&&w[0]?(w[0]/E*100).toFixed(0):0,"%)"]})]}),Object(v.jsx)("div",{className:"option-peng-bg",style:{width:"".concat(E&&w[0]?(w[0]/E*100).toFixed(0):0,"%")}})]}),Object(v.jsxs)("div",{className:"2"===f?"option-check option-checked":"option-check",onClick:function(){return ue("2")},children:[Object(v.jsxs)("div",{className:"dip-one-option-title option-title",children:[Object(v.jsxs)("div",{className:"option-check-text",children:[Object(v.jsx)("input",{type:"radio",name:"option",value:"2",id:"II",onChange:function(e){return ue("2")},checked:"2"===f}),Object(v.jsx)("label",{for:"II"}),Object(v.jsx)("span",{className:"option-title-text",children:"BNB Chain"})]}),Object(v.jsxs)("div",{className:"option-num",children:[w[1]?w[1].toFixed(0):0,"  ",n["deri-voting"]," (",E&&w[1]?(w[1]/E*100).toFixed(0):0,"%)"]})]}),Object(v.jsx)("div",{className:"option-peng-bg ",style:{width:"".concat(E&&w[1]?(w[1]/E*100).toFixed(0):0,"%")}})]}),Object(v.jsxs)("div",{className:"3"===f?"option-check option-checked":"option-check",onClick:function(){return ue("3")},children:[Object(v.jsxs)("div",{className:"dip-one-option-title option-title",children:[Object(v.jsxs)("div",{className:"option-check-text",children:[Object(v.jsx)("input",{type:"radio",name:"option",value:"2",id:"III",onChange:function(e){return ue("3")},checked:"3"===f}),Object(v.jsx)("label",{for:"III"}),Object(v.jsx)("span",{className:"option-title-text",children:"Polygon zkEVM"})]}),Object(v.jsxs)("div",{className:"option-num",children:[w[2]?w[2].toFixed(0):0,"  ",n["deri-voting"]," (",E&&w[2]?(w[2]/E*100).toFixed(0):0,"%)"]})]}),Object(v.jsx)("div",{className:"option-peng-bg ",style:{width:"".concat(E&&w[2]?(w[2]/E*100).toFixed(0):0,"%")}})]}),Object(v.jsxs)("div",{className:"4"===f?"option-check option-checked":"option-check",onClick:function(){return ue("4")},children:[Object(v.jsxs)("div",{className:"dip-one-option-title option-title",children:[Object(v.jsxs)("div",{className:"option-check-text",children:[Object(v.jsx)("input",{type:"radio",name:"option",value:"2",id:"VI",onChange:function(e){return ue("4")},checked:"4"===f}),Object(v.jsx)("label",{for:"VI"}),Object(v.jsx)("span",{className:"option-title-text",children:"zkSync Era"})]}),Object(v.jsxs)("div",{className:"option-num",children:[w[3]?w[3].toFixed(0):0,"  ",n["deri-voting"]," (",E&&w[3]?(w[3]/E*100).toFixed(0):0,"%)"]})]}),Object(v.jsx)("div",{className:"option-peng-bg ",style:{width:"".concat(E&&w[3]?(w[3]/E*100).toFixed(0):0,"%")}})]}),Object(v.jsxs)("div",{className:"power-time",children:["Last updated: ",ee," minutes ago"]}),Object(v.jsxs)("div",{className:"vote-button",children:[Object(v.jsxs)("div",{className:"your-power",children:["Your Voting Power :",Object(v.jsx)(u.a,{value:K,decimalScale:2})," DERI"]}),Object(v.jsx)(l.a,{disabled:U,label:n.vote,onClick:xe,width:"286",fontSize:"18"})]})]}),Object(v.jsxs)("div",{className:"dip-option-des-rules",children:[Object(v.jsx)("div",{className:"description-close-open",children:n.description}),Object(v.jsx)("div",{className:"description-text",children:Object(v.jsx)("div",{className:"ul-description",children:"The \u201ci-Chain\u201d, one of the two main components of Deri V4, represents the requesting interface and serves as a pivotal entry point for user interactions. It adeptly handles all the user requests, from traders initiating orders and managing margins to liquidity providers adding or removing liquidity. While theoretically any layer 1 or layer 2 (e.g. Arbitrum, BNBChain,Polygon zkEVM, and zkSync Era) can be adopted as an i-Chain, in practice, the community will choose which ones to deploy."})}),Object(v.jsxs)("div",{className:"vote-rules",children:[Object(v.jsx)("div",{className:"rules-title",children:n["voting-rules"]}),Object(v.jsxs)("div",{className:"rules-text",children:[Object(v.jsxs)("div",{className:"rules-margin",children:["Your voting power is the summation of the following balances in your wallet as of the deadline:",Object(v.jsxs)("ul",{className:"no-margin",children:[Object(v.jsx)("li",{children:"DERI balance"}),Object(v.jsx)("li",{children:"the corresponding DERI amount of your DERI-USDT SLP balance on SushiSwap"}),Object(v.jsx)("li",{children:"the corresponding DERI amount of your DERI-BUSD CLP balance on PancakeSwap"}),Object(v.jsx)("li",{children:"the corresponding DERI amount of your DERI-WETH LP balance on Uniswap V3"}),Object(v.jsx)("li",{children:"the corresponding DERI amount of your DLT balance in the DERI-based Inno Zone pools (BNB Chain)"})]})]}),Object(v.jsx)("div",{className:"rules-margin",children:"You can choose any of the 3 chains (ETH/Arbitrum/BNBChain) to sign your vote by the deadline"}),Object(v.jsx)("div",{className:"rules-margin",children:"Voting Deadline = 2023 Sep 8th 10:00:00AM UTC"}),Object(v.jsx)("div",{className:"rules-margin",children:"When a vote is submitted less than 15 min to the deadline, the deadline will be extended by 15 min. That is, the voting period will continue to extend until there is no vote within the last 15 min."}),Object(v.jsx)("div",{className:"rules-margin",children:"A snapshot will be taken at the block, at the deadline, and used to calculate the result."}),Object(v.jsx)("div",{className:"rules-margin",children:"Please note that, if you had voted before the deadline but then had transferred your DERI, SLP, PANCAKE-LP, Uniswap V3 LP or DLT before the deadline, it would be the balance at the deadline that counts."})]})]}),Object(v.jsxs)("div",{className:"supplementary-notes",children:[Object(v.jsx)("div",{className:"notes-title",children:"Reference Poll Link"}),Object(v.jsx)("div",{className:"notes-text",children:Object(v.jsx)("a",{rel:"noreferrer",target:"_blank",href:"https://snapshot.org/#/deri.eth/proposal/0x3eb5a59b02d1f038ebcead8405e442632ecdd835552e076b3066ab9fc185fbb9",children:"Snapshot"})})]}),Object(v.jsxs)("div",{className:"supplementary-notes",children:[Object(v.jsx)("div",{className:"notes-title",children:"Discussion"}),Object(v.jsx)("div",{className:"notes-text",children:Object(v.jsx)("a",{rel:"noreferrer",target:"_blank",href:"https://discord.com/invite/kb8ZbYgp8M",children:"Discord"})})]})]})]})]})})))}}]);
//# sourceMappingURL=44.e4e652f1.chunk.js.map
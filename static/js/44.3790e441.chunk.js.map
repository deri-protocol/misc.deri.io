{"version":3,"sources":["pages/Governance/DipSeven.js"],"names":["inject","observer","wallet","lang","useState","value","setValue","optionInfo","setOptionInfo","sumPower","setSumPower","deadline","setDeadline","setDisabled","isOptioned","setIsOptioned","votingPower","setVotingPower","setUseVotingPower","setTimeAgo","ArbUniDeri","setArbUniDeri","alert","useAlert","NFTContract","useContract","BTokenContract","PairContract","PoolContract","selectOption","useCallback","radioI","document","getElementById","radioII","radioIII","radioVI","click","getUserVotingPower","ApiProxy","request","detail","account","res","getUserVotingResult","console","log","option","getArbUniDeri","balanceOf","NFTNumber","BigNumber","from","_hex","toString","tokenId","index","tokenOfOwnerByIndex","id","push","deriTokenId","length","getPositionInfo","toLocaleLowerCase","data","map","item","obj","positions","tickLower","tickUpper","liquidity","Promise","all","slot0","tickCurrent","tick","amount","getAmountETHAndDeri","total_amount0","total_amount1","deri","eth","deriSum","reduce","accumulator","currentValue","getVotingResult","axios","get","JSON","parse","votes","timeNow","Date","MinNow","getMinutes","hoverNow","getHours","stemp","timestamp","timeAgo","MinAgo","hoverAgo","timeHover","timeMin","minTime","Number","bg","div","toNumber","findMaxMinSumIndex","max","min","sum","maxIndex","getVotingInfo","time","find","i","chainId","dedeadline","getTime","vote","includeResponse","success","error","useEffect","isConnected","plus","className","to","alt","src","backIcon","onClick","e","type","name","onChange","event","checked","for","toFixed","style","width","disabled","label","fontSize","rel","target","href"],"mappings":"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","file":"static/js/44.3790e441.chunk.js","sourcesContent":["import './dip.less'\r\nimport { Link } from 'react-router-dom'\r\nimport { inject, observer } from 'mobx-react'\r\nimport React, { useState, useEffect } from 'react'\r\nimport Button from '../../components/Button/Button'\r\nimport { useAlert } from 'react-alert'\r\nimport DeriNumberFormat from '../../utils/DeriNumberFormat'\r\nimport ApiProxy from '../../model/ApiProxy'\r\nimport backIcon from '../../assets/img/back.svg'\r\nimport axios from 'axios'\r\nimport { bg, findMaxMinSumIndex, getAmountETHAndDeri } from '../../utils/utils'\r\nimport { useCallback } from 'react'\r\nimport useContract from '../../hooks/useContractLp'\r\nimport { BigNumber } from 'ethers'\r\n\r\nfunction DipSeven({ wallet, lang }) {\r\n  const [value, setValue] = useState()\r\n  const [optionInfo, setOptionInfo] = useState([])\r\n  const [sumPower, setSumPower] = useState(0)\r\n  const [winner, setWinner] = useState()\r\n  const [deadline, setDeadline] = useState(false)\r\n  const [disabled, setDisabled] = useState(true)\r\n  const [isOptioned, setIsOptioned] = useState(false)\r\n  const [votingPower, setVotingPower] = useState(0)\r\n  const [useVotingPower, setUseVotingPower] = useState(0)\r\n  const [timeAgo, setTimeAgo] = useState(\"\")\r\n  const [ArbUniDeri, setArbUniDeri] = useState(0)\r\n  const alert = useAlert();\r\n  const NFTContract = useContract(\"IERC721\", 42161)\r\n  const BTokenContract = useContract(\"LpTokenId\", 42161)\r\n  const PairContract = useContract(\"PairAbi\", 42161)\r\n  const PoolContract = useContract(\"arbitrumLp\", 42161)\r\n  const PairAddress = \"0x96C3966534b4377691e11e163A0409Ad01667343\"\r\n\r\n  const selectOption = useCallback((value) => {\r\n    if (!isOptioned) {\r\n      let radioI = document.getElementById(\"I\")\r\n      let radioII = document.getElementById(\"II\")\r\n      let radioIII = document.getElementById(\"III\")\r\n      let radioVI = document.getElementById(\"VI\")\r\n      if (value === \"1\") {\r\n        radioI.click()\r\n      } else if (value === \"2\") {\r\n        radioII.click()\r\n      } else if (value === \"3\") {\r\n        radioIII.click()\r\n      } else if (value === \"4\") {\r\n        radioVI.click()\r\n      }\r\n      setValue(value)\r\n    }\r\n\r\n  }, [isOptioned])\r\n  const getUserVotingPower = async () => {\r\n    let res = await ApiProxy.request(\"getUserVotingPower\", [wallet.detail.account])\r\n    setVotingPower(res)\r\n  }\r\n  const getUserVotingResult = async () => {\r\n    let res = await ApiProxy.request(\"getUserVotingResult\", [wallet.detail.account])\r\n    console.log(\"getUserVotingResult\", res)\r\n    if (res.option !== \"0\") {\r\n      setValue(res.option)\r\n      setIsOptioned(true)\r\n    } else {\r\n      setIsOptioned(false)\r\n    }\r\n  }\r\n\r\n  const getArbUniDeri = useCallback(async () => {\r\n    let NFTNumber = await NFTContract.balanceOf(wallet.detail.account)\r\n    NFTNumber = BigNumber.from(NFTNumber._hex).toString()\r\n    let tokenId = []\r\n    for (let index = 0; index < NFTNumber; index++) {\r\n      let id = await NFTContract.tokenOfOwnerByIndex(wallet.detail.account, index)\r\n      id = BigNumber.from(id._hex).toString()\r\n      tokenId.push(id)\r\n    }\r\n    let deriTokenId = [];\r\n    for (let index = 0; index < tokenId.length; index++) {\r\n      let id = await PoolContract.getPositionInfo(tokenId[index])\r\n      if (id[0].toLocaleLowerCase() === PairAddress.toLocaleLowerCase()) {\r\n        deriTokenId.push(tokenId[index])\r\n      }\r\n    }\r\n    let data = deriTokenId.map(async (item) => {\r\n      let obj = {}\r\n      let res = await BTokenContract.positions(item)\r\n      obj = {\r\n        tickLower: res.tickLower,\r\n        tickUpper: res.tickUpper,\r\n        liquidity: BigNumber.from(res.liquidity._hex).toString()\r\n      }\r\n      return obj\r\n    })\r\n    data = await Promise.all(data)\r\n    let tickCurrent = await PairContract.slot0()\r\n    tickCurrent = tickCurrent.tick\r\n    let amount = data.map((item) => {\r\n      let [total_amount0, total_amount1] = getAmountETHAndDeri(tickCurrent, item.tickLower, item.tickUpper, item.liquidity)\r\n      return {\r\n        deri: total_amount0 / 10 ** 18,\r\n        eth: total_amount1 / 10 ** 18\r\n      }\r\n    })\r\n    let deriSum = amount.reduce((accumulator, currentValue) => {\r\n      return accumulator + currentValue.deri;\r\n    }, 0)\r\n    console.log(\"getArbUniDeri\", deriSum)\r\n    setArbUniDeri(deriSum)\r\n  }, [BTokenContract, PairContract, NFTContract, wallet.detail.account, PoolContract])\r\n\r\n  const getVotingResult = async () => {\r\n    let res = await axios.get(\"https://vote.deri.io/get_voting_powers\")\r\n    console.log(\"getVotingResult\", JSON.parse(res.data[0].votes))\r\n    if (res.data && res.data[0].votes) {\r\n      let timeNow = new Date()\r\n      let MinNow = timeNow.getMinutes()\r\n      let hoverNow = timeNow.getHours()\r\n      let stemp = res.data[0].timestamp * 1000\r\n      let timeAgo = new Date(stemp)\r\n      let MinAgo = timeAgo.getMinutes()\r\n      let hoverAgo = timeAgo.getHours()\r\n      let timeMin = MinNow - MinAgo\r\n      let timeHover = hoverNow - hoverAgo\r\n      if (timeMin >= 1 && timeHover <= 0) {\r\n        setTimeAgo(timeMin)\r\n      } else if (timeHover > 0) {\r\n        let min = 60 - MinAgo;\r\n        let minTime = min + Number(MinNow);\r\n        setTimeAgo(minTime)\r\n      } else if (timeMin < 1) {\r\n        let text = 'less than 1'\r\n        setTimeAgo(text)\r\n      }\r\n      res = JSON.parse(res.data[0].votes)\r\n      res = res.map(item => {\r\n        return bg(item).div(10 ** 18).toNumber()\r\n      })\r\n      let { max, min, sum, maxIndex } = findMaxMinSumIndex(res)\r\n      setSumPower(sum)\r\n      setOptionInfo(res)\r\n    }\r\n  }\r\n\r\n  const getVotingInfo = async () => {\r\n    let res = await ApiProxy.request(\"getVotingInfo\")\r\n    console.log(\"getVotingInfo\", res)\r\n    if (res && res.length) {\r\n      let time = res.find(i => +i.chainId === +wallet.detail.chainId)\r\n      time = time.dedeadline + \"000\"\r\n      let timestamp = new Date()\r\n      if (timestamp.getTime() >= +time) {\r\n        setDeadline(true)\r\n      } else {\r\n        setDeadline(false)\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  const vote = async () => {\r\n    console.log([wallet.detail.chainId, wallet.detail.account, value])\r\n    let res = await ApiProxy.request(\"vote\", [wallet.detail.chainId, wallet.detail.account, value], { includeResponse: true })\r\n    if (res.success) {\r\n      getUserVotingPower()\r\n      getUserVotingResult()\r\n      getVotingResult()\r\n      alert.success(\"Success\")\r\n    } else {\r\n      alert.error(\"Failed\")\r\n    }\r\n\r\n  }\r\n  useEffect(() => {\r\n    if (wallet.isConnected()) {\r\n      getUserVotingPower()\r\n      getUserVotingResult()\r\n      getVotingInfo()\r\n    }\r\n  }, [wallet, wallet.detail])\r\n  useEffect(() => {\r\n    getVotingResult()\r\n  }, [])\r\n  useEffect(() => {\r\n    if (wallet.isConnected() && value && !isOptioned && !deadline) {\r\n      setDisabled(false)\r\n    } else {\r\n      setDisabled(true)\r\n    }\r\n  }, [wallet.detail, value, optionInfo, isOptioned])\r\n\r\n  useEffect(() => {\r\n    let sum = 0\r\n    if (ArbUniDeri && votingPower) {\r\n      sum = bg(ArbUniDeri).plus(votingPower).toNumber()\r\n    } else if (votingPower) {\r\n      sum = votingPower\r\n    }\r\n    setUseVotingPower(sum)\r\n  }, [ArbUniDeri, votingPower])\r\n\r\n  useEffect(() => {\r\n    if (NFTContract && wallet.detail.account && PoolContract && BTokenContract && PairContract) {\r\n      getArbUniDeri()\r\n    }\r\n  }, [NFTContract, wallet.detail.account, PoolContract, BTokenContract, PairContract])\r\n  return (\r\n    <div className='dip-box'>\r\n      <div className='back-governance'>\r\n        <Link to='/governance'>\r\n          <div className='icon-back'>\r\n            <img alt='' src={backIcon} />\r\n            <span>{lang['back']}</span>\r\n          </div>\r\n        </Link>\r\n        <div className='poll-detail'>\r\n          {lang['poll-detail']}\r\n        </div>\r\n      </div>\r\n      <div className='dip-box-info'>\r\n        <div className='poll-dip-info '>\r\n          <div className='dip-list-title'>\r\n            <div className='title-text'>\r\n              {lang['dip']}-007\r\n            </div>\r\n            <div className='dip-progress'>\r\n              <div className='executed-bg'></div>\r\n              FINISHED\r\n            </div>\r\n          </div>\r\n          <div className='dip-list-des '>\r\n            Vote for Deri V4’s Second i-Chain\r\n          </div>\r\n          <div className='dip-time'>\r\n            Target End Time: 2023 Sep 15th 10:00:00AM UTC (subject to extension, see below for details)\r\n          </div>\r\n        </div>\r\n        <div className='dip-option'>\r\n          <div className={value === \"1\" ? \"option-check option-checked\" : \"option-check\"} onClick={(e) => selectOption(\"1\")} >\r\n            <div className='dip-one-option-title option-title'>\r\n              <div className='option-check-text'>\r\n                <input\r\n                  type='radio'\r\n                  name='option'\r\n                  value='1'\r\n                  id=\"I\"\r\n                  onChange={event => selectOption(\"1\")}\r\n                  checked={value === \"1\"}\r\n                />\r\n                <label for=\"I\"></label>\r\n                <span className='option-title-text'>\r\n                  Base\r\n                </span>\r\n              </div>\r\n              <div className='option-num'>\r\n                {/* 2128982 {lang['deri-voting']} (95%) */}\r\n                {optionInfo[0] ? optionInfo[0].toFixed(0) : 0} {lang['deri-voting']} ({sumPower && optionInfo[0] ? ((optionInfo[0] / sumPower) * 100).toFixed(0) : 0}%)\r\n              </div>\r\n            </div>\r\n            <div className='option-peng-bg' style={{ width: `${sumPower && optionInfo[0] ? ((optionInfo[0] / sumPower) * 100).toFixed(0) : 0}%` }}></div>\r\n          </div>\r\n          <div className={value === \"2\" ? \"option-check option-checked\" : \"option-check\"} onClick={() => selectOption(\"2\")} >\r\n            <div className='dip-one-option-title option-title'>\r\n              <div className='option-check-text'>\r\n                <input\r\n                  type='radio'\r\n                  name='option'\r\n                  value='2'\r\n                  id=\"II\"\r\n                  onChange={event => selectOption(\"2\")}\r\n                  checked={value === \"2\"}\r\n                />\r\n                <label for=\"II\"></label>\r\n                <span className='option-title-text'>\r\n                  Optimism\r\n                </span>\r\n              </div>\r\n              <div className='option-num'>\r\n                {/* 117159 {lang['deri-voting']} (5%) */}\r\n                {optionInfo[1] ? optionInfo[1].toFixed(0) : 0}  {lang['deri-voting']} ({sumPower && optionInfo[1] ? ((optionInfo[1] / sumPower) * 100).toFixed(0) : 0}%)\r\n              </div>\r\n            </div>\r\n            <div className='option-peng-bg ' style={{ width: `${sumPower && optionInfo[1] ? ((optionInfo[1] / sumPower) * 100).toFixed(0) : 0}%` }}></div>\r\n          </div>\r\n          <div className={value === \"3\" ? \"option-check option-checked\" : \"option-check\"} onClick={() => selectOption(\"3\")} >\r\n            <div className='dip-one-option-title option-title'>\r\n              <div className='option-check-text'>\r\n                <input\r\n                  type='radio'\r\n                  name='option'\r\n                  value='2'\r\n                  id=\"III\"\r\n                  onChange={event => selectOption(\"3\")}\r\n                  checked={value === \"3\"}\r\n                />\r\n                <label for=\"III\"></label>\r\n                <span className='option-title-text'>\r\n                  Polygon zkEVM\r\n                </span>\r\n              </div>\r\n              <div className='option-num'>\r\n                {/* 117159 {lang['deri-voting']} (5%) */}\r\n                {optionInfo[2] ? optionInfo[2].toFixed(0) : 0}  {lang['deri-voting']} ({sumPower && optionInfo[2] ? ((optionInfo[2] / sumPower) * 100).toFixed(0) : 0}%)\r\n              </div>\r\n            </div>\r\n            <div className='option-peng-bg ' style={{ width: `${sumPower && optionInfo[2] ? ((optionInfo[2] / sumPower) * 100).toFixed(0) : 0}%` }}></div>\r\n          </div>\r\n          <div className={value === \"4\" ? \"option-check option-checked\" : \"option-check\"} onClick={() => selectOption(\"4\")} >\r\n            <div className='dip-one-option-title option-title'>\r\n              <div className='option-check-text'>\r\n                <input\r\n                  type='radio'\r\n                  name='option'\r\n                  value='2'\r\n                  id=\"VI\"\r\n                  onChange={event => selectOption(\"4\")}\r\n                  checked={value === \"4\"}\r\n                />\r\n                <label for=\"VI\"></label>\r\n                <span className='option-title-text'>\r\n                  zkSync Era\r\n                </span>\r\n              </div>\r\n              <div className='option-num'>\r\n                {/* 117159 {lang['deri-voting']} (5%) */}\r\n                {optionInfo[3] ? optionInfo[3].toFixed(0) : 0}  {lang['deri-voting']} ({sumPower && optionInfo[3] ? ((optionInfo[3] / sumPower) * 100).toFixed(0) : 0}%)\r\n              </div>\r\n            </div>\r\n            <div className='option-peng-bg ' style={{ width: `${sumPower && optionInfo[3] ? ((optionInfo[3] / sumPower) * 100).toFixed(0) : 0}%` }}></div>\r\n          </div>\r\n          <div className='power-time'>\r\n            {/* Last updated: {timeAgo} minutes ago */}\r\n          </div>\r\n          <div className='vote-button'>\r\n            {/* <div className='your-power'>\r\n              Your Voting Power :\r\n              <DeriNumberFormat value={useVotingPower} decimalScale={2} /> DERI\r\n            </div> */}\r\n            <Button disabled={true} label={lang['vote']} onClick={vote} width='286' fontSize='18' />\r\n          </div>\r\n        </div>\r\n        <div className='dip-option-des-rules'>\r\n          <div className='description-close-open'>\r\n            {lang['description']}\r\n          </div>\r\n          <div className='description-text'>\r\n            <div className='ul-description'>\r\n              The “i-Chain”, one of the two main components of Deri V4, represents the requesting interface and serves as a pivotal entry point for user interactions. It adeptly handles all the user requests, from traders initiating orders and managing margins to liquidity providers adding or removing liquidity. While theoretically any layer 1 or layer 2 can be adopted as an i-Chain, in practice, the community will choose which ones to deploy.\r\n            </div>\r\n          </div>\r\n\r\n          <div className='vote-rules'>\r\n            <div className='rules-title'>\r\n              {lang['voting-rules']}\r\n            </div>\r\n            <div className='rules-text'>\r\n              <div className='rules-margin'>\r\n                Your voting power is the summation of the following balances in your wallet as of the deadline:\r\n                <ul className='no-margin'>\r\n                  <li>DERI balance</li>\r\n                  <li>the corresponding DERI amount of your DERI-USDT SLP balance on SushiSwap</li>\r\n                  <li>the corresponding DERI amount of your DERI-BUSD CLP balance on PancakeSwap</li>\r\n                  <li>the corresponding DERI amount of your DERI-WETH LP balance on Uniswap V3</li>\r\n                  <li>the corresponding DERI amount of your DLT balance in the DERI-based Inno Zone pools (BNB Chain)</li>\r\n                </ul>\r\n              </div>\r\n              <div className='rules-margin'>\r\n                You can choose any of the 3 chains (ETH/Arbitrum/BNBChain) to sign your vote by the deadline\r\n              </div>\r\n              <div className='rules-margin'>\r\n                Voting Deadline = 2023 Sep 15th 10:00:00AM UTC\r\n              </div>\r\n              <div className='rules-margin'>\r\n                When a vote is submitted less than 15 min to the deadline, the deadline will be extended by 15 min. That is, the voting period will continue to extend until there is no vote within the last 15 min.\r\n              </div>\r\n              <div className='rules-margin'>\r\n                A snapshot will be taken at the block, at the deadline, and used to calculate the result.\r\n              </div>\r\n              <div className='rules-margin'>\r\n                Please note that, if you had voted before the deadline but then had transferred your DERI, SLP, PANCAKE-LP, Uniswap V3 LP or DLT before the deadline, it would be the balance at the deadline that counts.\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className='supplementary-notes'>\r\n            <div className='notes-title'>\r\n              Reference Poll Link\r\n            </div>\r\n            <div className='notes-text'>\r\n              <a rel=\"noreferrer\" target=\"_blank\" href=\"https://snapshot.org/#/deri.eth/proposal/0x0f3567162f347ac566aab415473a5dd3c00944060f09ab7d2f6e953606b7964b\">Snapshot</a>\r\n            </div>\r\n          </div>\r\n          <div className='supplementary-notes'>\r\n            <div className='notes-title'>\r\n              Discussion\r\n            </div>\r\n            <div className='notes-text'>\r\n              <a rel=\"noreferrer\" target=\"_blank\" href=\"https://discord.com/invite/kb8ZbYgp8M\">Discord</a>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\nexport default inject('wallet')(observer(DipSeven))\r\n\r\n\r\n"],"sourceRoot":""}